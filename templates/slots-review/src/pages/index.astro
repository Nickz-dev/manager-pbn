---
import siteData from '../data/site-data.json';

const { site, articles, categories, authors } = siteData;

// –ü–æ–ª—É—á–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å—Ç–∞—Ç—å–∏
const latestArticles = articles
  .filter(article => article.publishedAt)
  .sort((a, b) => new Date(b.publishedAt).getTime() - new Date(a.publishedAt).getTime())
  .slice(0, 9);

// –ü–æ–ª—É—á–∞–µ–º –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
const popularCategories = categories.slice(0, 5);

// –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
const structuredData = {
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": site.name,
  "url": `https://${site.domain}`,
  "description": site.description,
  "publisher": {
    "@type": "Organization",
    "name": site.name,
    "url": `https://${site.domain}`
  }
};

// –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º Open Graph –¥–∞–Ω–Ω—ã–µ
const ogData = {
  title: site.name,
  description: site.description,
  url: `https://${site.domain}`,
  type: 'website',
  site_name: site.name,
  image: site.og_image || `/images/default-og.jpg`
};
---

<!DOCTYPE html>
<html lang={site.config?.language || 'en'}>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#8b5cf6">
  
  <!-- Primary Meta Tags -->
  <title>{site.name} - {site.description}</title>
  <meta name="title" content={site.name}>
  <meta name="description" content={site.description}>
  <meta name="keywords" content={site.keywords?.join(', ') || ''}>
  <meta name="author" content={site.name}>
  <meta name="robots" content="index, follow">
  <meta name="language" content={site.config?.language || 'en'}>
  
  <!-- Canonical URL -->
  <link rel="canonical" href={`https://${site.domain}`}>
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content={ogData.type}>
  <meta property="og:url" content={ogData.url}>
  <meta property="og:title" content={ogData.title}>
  <meta property="og:description" content={ogData.description}>
  <meta property="og:image" content={ogData.image}>
  <meta property="og:site_name" content={ogData.site_name}>
  <meta property="og:locale" content={site.config?.language || 'en_US'}>
  
  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content={ogData.url}>
  <meta property="twitter:title" content={ogData.title}>
  <meta property="twitter:description" content={ogData.description}>
  <meta property="twitter:image" content={ogData.image}>
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  
  <!-- Tailwind CSS (local build) -->
  <link rel="stylesheet" href="/src/styles/globals.css">
  
  <!-- Preload critical resources -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;900&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;900&display=swap"></noscript>
  
  <!-- Google Analytics -->
  {site.analytics?.googleAnalytics && (
    <script async src={`https://www.googletagmanager.com/gtag/js?id=${site.analytics.googleAnalytics}`}></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', '{site.analytics.googleAnalytics}', {
        page_title: '{site.name}',
        page_location: '{ogData.url}'
      });
    </script>
  )}
  
  <!-- Structured Data -->
  <script type="application/ld+json" set:html={JSON.stringify(structuredData)}></script>
</head>
<body>
  <header class="bg-gradient-to-r from-purple-500 to-orange-500 text-white py-16">
    <div class="container mx-auto px-4 text-center">
      <h1 class="text-5xl font-bold mb-4">üé∞ {site.name}</h1>
      <p class="text-xl opacity-90 max-w-2xl mx-auto">{site.description}</p>
    </div>
  </header>

  <main class="py-16 bg-gradient-to-br from-gray-900 to-gray-800 min-h-screen">
    <div class="container mx-auto px-4">
      {latestArticles.length > 0 ? (
        <>
          <h2 class="text-4xl font-bold text-center mb-12 text-white">Latest Slot Reviews</h2>
          <div class="space-y-8 mb-16">
            {latestArticles.map((article, index) => (
              <article class="bg-gray-800 rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300">
                <a href={`/articles/${article.slug}`} class="block">
                  {index === 0 && (
                    <div class="absolute top-4 right-4 bg-gradient-to-r from-purple-500 to-orange-500 text-white px-3 py-1 rounded-full text-sm font-semibold">
                      Featured
                    </div>
                  )}
                  <div class="flex flex-col md:flex-row">
                    {article.featured_image ? (
                      <img 
                        src={article.featured_image} 
                        alt={article.title} 
                        class="w-full md:w-80 h-48 md:h-auto object-cover"
                        loading="lazy"
                      />
                    ) : (
                      <div class="w-full md:w-80 h-48 md:h-auto bg-gradient-to-br from-gray-700 to-gray-600 flex items-center justify-center text-gray-400 text-xl">
                        üé∞ No Image
                      </div>
                    )}
                    <div class="p-6 flex-1">
                      <h3 class="text-xl font-bold mb-3 text-white">{article.title}</h3>
                      {article.excerpt && (
                        <p class="text-gray-300 mb-4">{article.excerpt}</p>
                      )}
                      <div class="flex justify-between items-center text-sm text-gray-400">
                        <div class="flex items-center gap-2">
                          <div class="w-6 h-6 bg-gradient-to-r from-purple-500 to-orange-500 rounded-full flex items-center justify-center text-white text-xs font-semibold">
                            {(article.author?.name || 'A').charAt(0).toUpperCase()}
                          </div>
                          <span>{article.author?.name || 'Anonymous'}</span>
                        </div>
                        <span>
                          {article.publishedAt ? new Date(article.publishedAt).toLocaleDateString() : 'No date'}
                        </span>
                      </div>
                    </div>
                  </div>
                </a>
              </article>
            ))}
          </div>
        </>
      ) : (
        <div class="text-center py-16">
          <h2 class="text-3xl font-bold mb-4 text-white">No articles available</h2>
          <p class="text-gray-400">Check back soon for new content!</p>
        </div>
      )}

      {popularCategories.length > 0 && (
        <div class="mb-16">
          <h2 class="text-4xl font-bold text-center mb-12 text-white">Popular Categories</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {popularCategories.map((category) => (
              <a href={`/categories/${category.slug}`} class="block">
                <div class="bg-gray-800 rounded-lg shadow-md p-6 text-center hover:shadow-lg transition-shadow duration-300">
                  <h3 class="text-xl font-semibold mb-2 text-white">{category.name}</h3>
                  <p class="text-gray-400">Explore the latest content in {category.name.toLowerCase()}</p>
                </div>
              </a>
            ))}
          </div>
        </div>
      )}
    </div>
  </main>

  <footer class="bg-gray-800 border-t border-gray-700 py-12">
    <div class="container mx-auto px-4">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
        <div>
          <h3 class="text-xl font-semibold mb-4 text-white">About {site.name}</h3>
          <p class="text-gray-400">{site.description}</p>
        </div>
        <div>
          <h3 class="text-xl font-semibold mb-4 text-white">Categories</h3>
          <ul class="space-y-2">
            {popularCategories.map((category) => (
              <li><a href={`/categories/${category.slug}`} class="text-gray-400 hover:text-purple-400 transition-colors">{category.name}</a></li>
            ))}
          </ul>
        </div>
        <div>
          <h3 class="text-xl font-semibold mb-4 text-white">Contact</h3>
          <p class="text-gray-400">Email: info@{site.domain}</p>
          <p class="text-gray-400">Follow us on social media</p>
        </div>
      </div>
      <div class="text-center mt-8 pt-8 border-t border-gray-700 text-gray-500">
        <p>&copy; {new Date().getFullYear()} {site.name}. All rights reserved.</p>
      </div>
    </div>
  </footer>
</body>
</html> 